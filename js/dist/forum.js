(()=>{var e={n:t=>{var o=t&&t.__esModule?()=>t.default:()=>t;return e.d(o,{a:o}),o},d:(t,o)=>{for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};(()=>{"use strict";const t=flarum.core.compat["common/app"];var o=e.n(t);const n=flarum.core.compat["common/extend"],r=flarum.core.compat["common/components/TextEditor"];var a=e.n(r);function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function c(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,i(e,t)}const l=flarum.core.compat["common/Component"];var s=e.n(l);const u=flarum.core.compat["common/components/Button"];var p=e.n(u);const f=flarum.core.compat["common/components/Tooltip"];var d=e.n(f);function b(e,t,o){return e?t:o||""}function y(e,t){var o=e;return function(){var e=o;return o+=t,e}}const g=flarum.core.compat["common/utils/classList"];var h=e.n(g);function v(e,t){var o,n,r,a=(null==(o=e.offsetParent())||null==(n=o.offset())?void 0:n.left)||0,i=(null==(r=e.offset())?void 0:r.left)||0,c=$(document.body).width()||0,l=t.width()||0,s=i;s+l>c&&(s=c-l),s<0&&(s=0),t.css({left:s-a})}var x=function(e){function t(){for(var t,o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))||this).selectedSub="",t.applyStyleInline=function(e){var o,n,r=t.attrs.editor,a=null!=(o=null==e?void 0:e.prefix)?o:"",i=null!=(n=null==e?void 0:e.suffix)?n:"";if(null!=r&&r.getSelectionRange&&null!=r&&r.getValue&&null!=r&&r.replaceSelection){var c=r.getSelectionRange(),l=c.start,s=c.end,u=r.getValue().slice(l,s),p=a+u+i;if(r.replaceSelection(p),null==r.focus||r.focus(),!u&&i){var m=l+a.length;null==r.setSelectionRange||r.setSelectionRange(m,m)}}else{var f=document.querySelector(".ComposerBody textarea");if(f){var d,b,y=null!=(d=f.selectionStart)?d:f.value.length,g=null!=(b=f.selectionEnd)?b:f.value.length,h=f.value.slice(y,g),v=a+h+i;if(f.setRangeText(v,y,g,"end"),f.dispatchEvent(new Event("input",{bubbles:!0})),f.focus(),!h&&i){var x=y+a.length;f.setSelectionRange(x,x)}}}},t}c(t,e);var o=t.prototype;return o.view=function(){var e=this,o=this.attrs.rows||1,n=this.attrs.tagCollect.get(),r=n.filter((function(e){return"group"===e.type})),a=(this.attrs.bottom||0)+3;return m("div",{className:h()("ButtonBar",this.attrs.className),style:"bottom:"+a+"px;"},this.getTags(n,o),r.map((function(n){return t.component({editor:e.attrs.editor,tagCollect:n.tags,className:"SubButtons"+b(e.selectedSub===n.name," show",""),rows:n.rows,bottom:36*o})})))},o.onupdate=function(t){e.prototype.onupdate.call(this,t),this.selectedSub&&v($(this.element).find(".Button.selected"),$(this.element).children(".show"))},o.getTags=function(e,t){for(var o=[[]],n=Math.floor((e.length+t-1)/t),r=0,a=0;a<e.length;a++)o[r].push(this.getTagComponent(e[a])),(a+1)%n==0&&(r++,o.push([]));return o.map((function(e){return m("div",{className:"ButtonBar-row"},e)}))},o.getTagComponent=function(e){if("space"===e.type)return m("div",{className:"ButtonBar-space"});if("collect"===e.type)return e.component;var t="Button Button--link";return"group"===e.type&&(t+=" GroupBtn"),"string"==typeof e.icon&&(t+=" Button--icon"),e.name===this.selectedSub&&(t+=" selected"),e.icon?"string"==typeof e.icon?m(d(),{text:e.tooltip,position:"bottom"},m(p(),{className:t,icon:e.icon,onclick:this.clickEventWarper(e)})):"function"==typeof e.icon?m(d(),{text:e.tooltip,position:"bottom"},m(p(),{className:t,onclick:this.clickEventWarper(e)},e.icon())):m(d(),{text:e.tooltip,position:"bottom"},m(p(),{className:t,onclick:this.clickEventWarper(e)},e.icon.component.component(e.icon.attrs))):m(p(),{className:t,onclick:this.clickEventWarper(e)},e.tooltip)},o.clickEventWarper=function(e){var t=this;return function(o){o.currentTarget.blur(),t.clickEvent(e)}.bind(this)},o.clickEvent=function(e){var t=this;if("group"===e.type)return this.selectedSub=e.name,void m.redraw();if("button"===e.type)if("function"!=typeof e.style)this.applyStyleInline(e.style);else{var o=e.style();o instanceof Promise?o.then((function(e){return e&&t.applyStyleInline(e)})):o&&this.applyStyleInline(o)}},t}(s());const w=flarum.core.compat["forum/app"];var k=e.n(w);const T=flarum.core.compat["common/utils/ItemList"];var N=e.n(T),B=function(){function e(){this.tags=new(N()),this.spaceKey=0}var t=e.prototype;return t.getTranslation=function(e){return"string"==typeof e?k().translator.trans(e):k().translator.trans(e.key,e.params)},t.add=function(e,t,o,n,r){return this.tags.add(t,{type:"button",name:t,icon:o,tooltip:this.getTranslation(n),style:r},e),this},t.collect=function(e,t,o){this.tags.add(t,{type:"collect",name:t,component:o},e)},t.space=function(e){return this.tags.add("space-"+this.spaceKey++,{type:"space"},e),this},t.group=function(t,o,n,r,a,i){void 0===i&&(i=1);var c=new e;return a(c),this.tags.add(o,{type:"group",name:o,icon:n,tooltip:this.getTranslation(r),tags:c,rows:i},t),c},t.item=function(e){return this.tags.get(e)},t.clear=function(){var e=this;Object.keys(this.tags.toObject()).forEach((function(t){return e.tags.remove(t)}))},t.remove=function(e){this.tags.remove(e)},t.get=function(){var e=this.tags.toArray(),t=k().forum.attribute("bbcode-disable");return e.filter((function(e){return!t[e.itemName]})).reverse()},e}();function E(e){return k().translator.trans("xypp-more-bbcode.forum.common."+e)+""}function S(e){var t,o,n=((null==(t=k().session)||null==(o=t.user)?void 0:o.preferences())||{})["xypp-more-bbcode-"+e];return n||(n=k().forum.attribute("xypp-more-bbcode-"+e)),n}function D(e,t){return function(){return"all"===(o=S("pref-markdown"))||"none"!==o&&A()?t:e;var o}}function A(){return M(S("collect-all"))}function M(e){if("none"==e)return!1;if("all"==e)return!0;var t=k().screen();return"phone"===e&&"phone"===t||"tablet"===e&&("phone"===t||"tablet"===t)}function O(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return Object.assign.apply(Object,[{}].concat(t))}function _(e,t,o){return void 0===o&&(o=!0),t||(t=e),{prefix:e,suffix:t,trimFirst:o}}function j(e,t){return void 0===t&&(t=!0),{prefix:e,trimFirst:t}}function P(e,t){void 0===t&&(t=!1);var o=/\[([a-zA-Z0-9_-]+)/.exec(e);return o?_(e,"[/"+o[1]+"]",t):{}}const H=flarum.core.compat["common/components/Modal"];var C=e.n(H);const I=flarum.core.compat["common/components/Select"];var z=e.n(I);function q(e,t){var o=k().translator.trans("xypp-more-bbcode.forum.alert."+e,t);return Array.isArray(o)?o.join(""):o}var R=function(e){function t(){for(var t,o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))||this).done=!1,t.typesOpt={},t.availableMap={success:["a","b","c","d"],warning:["a","b","c","d"],error:["a","b","c","d"],notice:["a","b","c","d"],basic:["a"],custom:["a","b"]},t.colorMap={success:["green","white","green"],error:["red","white","red"],notice:["teal","white","teal"],warning:["darkorange","white","darkorange"],custom:["red","white","red"]},t.available=["a","b","c","d"],t.type="notice",t.style="a",t}c(t,e);var o=t.prototype;return o.oninit=function(t){e.prototype.oninit.call(this,t),this.typesOpt={success:q("type.success")+"",warning:q("type.warning")+"",error:q("type.error")+"",notice:q("type.notice")+"",basic:q("type.basic")+"",custom:q("type.custom")+""}},o.className=function(){return"alertPreviewModal Modal--small"},o.title=function(){return q("title")},o.content=function(){var e=this,t={};return this.available.forEach((function(e){t[e]=e})),m("div",{className:"Modal-body"},m("div",{className:"Form-group"},m("label",{for:"xypp-more-bbcode-alert-type"},q("type.label")),m(z(),{options:this.typesOpt,value:this.type,onchange:function(t){e.type=t,e.available=e.availableMap[t]}.bind(this)})),m("div",{className:"Form-group"},m("label",{for:"xypp-more-bbcode-alert-type"},q("style")),m(z(),{options:t,value:this.style,onchange:function(t){e.style=t}.bind(this)})),m("div",{className:"bbcode-alert-preview"}),m(p(),{className:"Button Button--primary",type:"submit"},q("insert")))},o.generateStyle=function(){var e=this.style,t=this.type;if("custom"===this.type)return"a"===this.style?P("[acustom]"+this.colorMap.custom.join(",")+","+q("defaults.content",{type:t,style:e})):"b"===this.style?P("[bcustom]title="+q("defaults.content",{type:t,style:e})+" font="+this.colorMap.custom[0]+" bg="+this.colorMap.custom[1]+" border="+this.colorMap.custom[2]):{};switch(this.style){case"a":return P("[a"+this.type+"]"+q("defaults.content",{type:t,style:e}));case"b":return P("[b"+this.type+"]"+q("defaults.content",{type:t,style:e}));case"c":return P("[c"+this.type+"]"+this.colorMap[t].join(",")+","+q("defaults.title")+","+q("defaults.content",{type:t,style:e}));case"d":return P("[d"+this.type+" title="+q("defaults.title")+" font="+this.colorMap.custom[0]+" bg="+this.colorMap.custom[1]+" border="+this.colorMap.custom[2]+"]"+q("defaults.content",{type:t,style:e}));default:return{}}},o.generateBBCode=function(){var e=this.generateStyle();return e.prefix+""+(e.suffix||"")},o.onupdate=function(t){e.prototype.onupdate.call(this,t),s9e.TextFormatter.preview(this.generateBBCode(),this.$(".bbcode-alert-preview")[0])},o.onsubmit=function(e){e.preventDefault(),this.done=!0,this.attrs.onsubmit(this.generateStyle()),k().modal.close()},o.onbeforeremove=function(e){this.done||this.attrs.oncancel()},t}(C());const F=flarum.core.compat["forum/components/CommentPost"];var L=e.n(F);const W=flarum.core.compat["forum/components/ComposerPostPreview"];var Y=e.n(W);function G(){return new Promise((function(e,t){k().modal.show(R,{onsubmit:e,oncancel:t})}))}var K=0;function V(){this.$(".tabs").each((function(e,t){var o=$(t);if(!o.find('input[type="radio"][name]').length){var n=o.find('.tabs-title > .tab > input[type="radio"]');if(n.length){var r=o.find(".tab"),a=K++;n.attr("name","tab-group-"+a),n.is("[checked]")||n[0].setAttribute("checked","checked"),r.each((function(e,t){var o=$(t),n="tab-"+a+"-"+ ++e;o.find('input[type="radio"]').attr("id",n),o.find("label").attr("for",n)}))}}}))}const U=flarum.core.compat["common/components/TextEditorButton"];var Z=e.n(U);function J(e,t){var o=k().translator.trans("xypp-more-bbcode.forum.cloud."+e,t);return Array.isArray(o)?o.join(""):o}var Q=function(e){function t(){for(var t,o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];return(t=e.call.apply(e,[this].concat(n))||this).done=!1,t.opts={},t.type="other",t}c(t,e);var o=t.prototype;return o.oninit=function(t){e.prototype.oninit.call(this,t),this.opts=k().forum.attribute("bbcode-cloud")},o.className=function(){return"alertPreviewModal Modal--small"},o.title=function(){return J("title")},o.content=function(){var e=this;return m("div",{className:"Modal-body"},m("div",{className:"Form-group"},m("label",{for:"xypp-more-bbcode-cloud-type"},J("type.label")),m(z(),{options:this.opts,value:this.type,onchange:function(t){e.type=t}.bind(this)})),m("div",{className:"bbcode-cloud-preview"}),m(p(),{className:"Button Button--primary",type:"submit"},J("insert")))},o.generateStyle=function(){return P('[cloud type="'+this.type+'" title="'+E("title")+'" url="'+E("url")+'"]'+J("content.defaults"))},o.generateBBCode=function(){var e=this.generateStyle();return e.prefix+""+(e.suffix||"")},o.onupdate=function(t){e.prototype.onupdate.call(this,t),s9e.TextFormatter.preview(this.generateBBCode(),this.$(".bbcode-cloud-preview")[0])},o.onsubmit=function(e){e.preventDefault(),this.done=!0,this.attrs.onsubmit(this.generateStyle()),k().modal.close()},o.onbeforeremove=function(e){this.done||this.attrs.oncancel()},t}(C());function X(){return new Promise((function(e,t){k().modal.show(Q,{onsubmit:e,oncancel:t})}))}const ee=flarum.core.compat["forum/components/DiscussionPage"];var te=e.n(ee);const oe=flarum.core.compat["forum/utils/DiscussionControls"];var ne=e.n(oe);const re=flarum.core.compat["forum/components/LogInModal"];var ae=e.n(re);const ie=flarum.core.compat["common/components/FieldSet"];var ce=e.n(ie);const le=flarum.core.compat["forum/components/SettingsPage"];var se=e.n(le);function ue(e,t){var n=o().translator.trans("xypp-more-bbcode.forum."+e,t);return Array.isArray(n)?n.join(""):n}o().initializers.add("xypp/more-bbcode",(function(){var e=new B,t=y(100,100);!function(e,t){e.group(t(),"fonts","fas fa-bold","xypp-more-bbcode.forum.fonts.title",(function(e){var t=y(100,100);e.add(t(),"bold","fas fa-bold","xypp-more-bbcode.forum.fonts.bold",D(P("[b]"),_("**"))),e.add(t(),"italic","fas fa-italic","xypp-more-bbcode.forum.fonts.italic",D(P("[i]"),_("*"))),e.add(t(),"strike-through","fas fa-strikethrough","xypp-more-bbcode.forum.fonts.strike_through",D(P("[del]"),_("~~"))),e.add(t(),"underline","fas fa-underline","xypp-more-bbcode.forum.fonts.underline",P("[ins]"))})),e.group(t(),"typography","fas fa-paragraph","xypp-more-bbcode.forum.typography.title",(function(e){var t=y(100,100);e.add(t(),"url","fas fa-link","xypp-more-bbcode.forum.typography.link",D(P("[URL="+E("url")+" title="+E("title")+"]"),O(_("[","]("+E("url")+")"),{replaceNext:"https://",scanFor:"https?://"}))),e.add(t(),"image","fas fa-image","xypp-more-bbcode.forum.typography.image",D(j('[IMG src="'+E("url")+'" title="'+E("title")+'" alt="'+E("simple")+'" height="auto" width="auto"]'),O(_("![","]("+E("url")+")"),{replaceNext:"https://",scanFor:"https?://"}))),e.add(t(),"quote","fas fa-quote-right","xypp-more-bbcode.forum.typography.quote",D(O(P("[quote]"),{multiline:!0}),O(j("> "),{multiline:!0,surroundWithNewlines:!0}))),e.add(t(),"code","fas fa-code","xypp-more-bbcode.forum.typography.code",D(O(P("[code lang="+E("any")+"]"),{multiline:!0}),O(_("`",void 0,!1),{blockPrefix:"```",blockSuffix:"```"}))),e.add(t(),"spoiler","fas fa-eye-slash","xypp-more-bbcode.forum.typography.spoiler",D(O(P("[spoiler title="+E("title")+"]"),{multiline:!0}),O(_(">!","!<"),{blockPrefix:">! ",multiline:!0}))),e.add(t(),"dropcap","fas fa-caret-right","xypp-more-bbcode.forum.typography.dropcap",P("[dropcap] ")),e.space(t()),e.add(t(),"horizontal-line","fas fa-minus","xypp-more-bbcode.forum.typography.horizontal_line",P("[hr]")),e.add(t(),"table","fas fa-table","xypp-more-bbcode.forum.typography.table",D(j("\n[TABLE]\n    [THEAD]\n        [TH]"+E("column")+"[TH]\n        [TH]"+E("column")+"[TH]\n        [TH]"+E("any")+"[TH]\n    [/THEAD]\n    [TBODY]\n        [TR]\n            [TD]"+E("text")+"[TD]\n            [TD]"+E("text")+"[TD]\n            [TD]"+E("any")+"[TD]\n        [/TR]\n    [/TBODY]\n[/TABLE]\n"),j("\n| "+E("column")+" | "+E("column")+" | "+E("column")+" | "+E("column")+" |\n|---|---|---|---|\n| "+E("any")+" | "+E("any")+" | "+E("any")+" | "+E("any")+" |\n"))),e.add(t(),"list-ul","fas fa-list-ul","xypp-more-bbcode.forum.typography.unordered_list",D(j("\n[list]\n[*]"+E("any")+"\n[*]"+E("any")+"\n[*]"+E("any")+"\n[/list]\n"),O(j("\n- "),{multiline:!0,surroundWithNewlines:!0}))),e.add(t(),"list-ol","fas fa-list-ol","xypp-more-bbcode.forum.typography.ordered_list",D(j("\n[list=1]\n[*]"+E("any")+"\n[*]"+E("any")+"\n[*]"+E("any")+"\n[/list]\n"),O(j("\n1. "),{multiline:!0,orderedList:!0,surroundWithNewlines:!0})))})),e.group(t(),"heading","fas fa-heading","xypp-more-bbcode.forum.heading.title",(function(e){var t=y(100,100);[1,2,3,4,5,6].forEach((function(o){e.add(t(),"heading-"+o,!1,{key:"xypp-more-bbcode.forum.heading.label",params:{level:o}},D(P("[H"+o+"]"),_("#".repeat(o)+" "," "+"#".repeat(o))))}))})),e.group(t(),"align","fas fa-align-justify","xypp-more-bbcode.forum.align.title",(function(e){var t=y(100,100);e.add(t(),"align-left","fas fa-align-left","xypp-more-bbcode.forum.align.align_left",P("[left]")),e.add(t(),"align-center","fas fa-align-center","xypp-more-bbcode.forum.align.align_center",P("[center]")),e.add(t(),"align-right","fas fa-align-right","xypp-more-bbcode.forum.align.align_right",P("[right]")),e.add(t(),"justify","fas fa-align-justify","xypp-more-bbcode.forum.align.align_justify",P("[justify]")),e.space(t()),e.add(t(),"padding-left","fas fa-arrow-alt-circle-left","xypp-more-bbcode.forum.align.padding_left",P("[pleft]")),e.add(t(),"padding-right","fas fa-arrow-alt-circle-right","xypp-more-bbcode.forum.align.padding_right",P("[pright]")),e.space(t()),e.add(t(),"image-left",(function(){return m("div",{className:"stackIcon"},m("i",{className:"fas fa-image main"}),m("i",{className:"fas fa-arrow-alt-circle-left lb-corner"}))}),"xypp-more-bbcode.forum.align.image_left",P("[ileft]")),e.add(t(),"image-center",(function(){return m("div",{className:"stackIcon"},m("i",{className:"fas fa-image main"}),m("i",{className:"fas fa-arrow-alt-circle-up cb-corner"}))}),"xypp-more-bbcode.forum.align.image_center",P("[icenter]")),e.add(t(),"image-right",(function(){return m("div",{className:"stackIcon"},m("i",{className:"fas fa-image main"}),m("i",{className:"fas fa-arrow-alt-circle-right rb-corner"}))}),"xypp-more-bbcode.forum.align.image_right",P("[iright]"))})),e.group(t(),"size","fas fa-text-height","xypp-more-bbcode.forum.size.title",(function(e){var t=y(100,100);[18,20,22,24,26,28,30,32,34,36,38,40].forEach((function(o){e.add(t(),"size-"+o,!1,{key:"xypp-more-bbcode.forum.size.label",params:{size:o}},P("[size="+o+"]"))}))}),2),e.group(t(),"color","fas fa-palette","xypp-more-bbcode.forum.color.title",(function(e){var t=y(100,100);["grey","green","blue","purple","yellow","orange","red","silver","pink","brown","white","black"].forEach((function(o){e.add(t(),"color-"+o,(function(){return m("span",{style:"background:"+o+";",className:"color-indicator text"},"A")}),{key:"xypp-more-bbcode.forum.color.label",params:{color:o}},P("[color="+o+"]"))}))}),2),e.group(t(),"background",(function(){return m("i",{className:"fas fa-fill-drip"})}),"xypp-more-bbcode.forum.background.title",(function(e){var t=y(100,100);["grey","green","blue","purple","yellow","orange","red","silver","pink","brown","white","black"].forEach((function(o){e.add(t(),"background-"+o,(function(){return m("span",{style:"background:"+o+";",className:"color-indicator back"})}),{key:"xypp-more-bbcode.forum.background.label",params:{color:o}},P("[background="+o+"]"))}))}),2),e.group(t(),"sign","fas fa-superscript","xypp-more-bbcode.forum.sign.title",(function(e){var t=y(100,100);e.add(t(),"superscript","fas fa-superscript","xypp-more-bbcode.forum.sign.superscript",P("[sup]")),e.add(t(),"subscript","fas fa-subscript","xypp-more-bbcode.forum.sign.subscript",P("[sub]")),e.add(t(),"acronym","fas fa-question-circle","xypp-more-bbcode.forum.sign.acronym",P('[acronym title="'+E("title")+'"] '+E("describe")))}))}(e,t),function(e,t){e.group(t(),"container","fas fa-square","xypp-more-bbcode.forum.container.title",(function(e){var t=y(100,100);e.add(t(),"table","fas fa-table","xypp-more-bbcode.forum.container.table",D(j("\n[TABLE]\n    [THEAD]\n        [TH]"+E("column")+"[TH]\n        [TH]"+E("column")+"[TH]\n        [TH]"+E("any")+"[TH]\n    [/THEAD]\n    [TBODY]\n        [TR]\n            [TD]"+E("text")+"[TD]\n            [TD]"+E("text")+"[TD]\n            [TD]"+E("any")+"[TD]\n        [/TR]\n    [/TBODY]\n[/TABLE]\n"),j("\n| "+E("column")+" | "+E("column")+" | "+E("column")+" | "+E("column")+" |\n|---|---|---|---|\n| "+E("any")+" | "+E("any")+" | "+E("any")+" | "+E("any")+" |\n"))),e.add(t(),"quote","fas fa-quote-right","xypp-more-bbcode.forum.container.quote",D(P("[quote]"),O(j(">"),{multiline:!0,surroundWithNewlines:!0}))),e.add(t(),"details","fas fa-info-circle","xypp-more-bbcode.forum.container.details",O(P('[details="TITLE"] CONTENT '),{blockPrefix:"[/details]"})),e.add(t(),"tabs","fas fa-columns","xypp-more-bbcode.forum.container.tabs",j('\n[tabs]\n[tab="'+E("column")+'"]'+E("text")+'[/tab]\n[tab="'+E("any")+'"]'+E("text")+"[/tab]\n[/tabs]\n")),e.add(t(),"alert","fas fa-exclamation-triangle","xypp-more-bbcode.forum.container.alert",G),e.space(t()),e.add(t(),"iframe","fas fa-window-maximize","xypp-more-bbcode.forum.container.iframe",_('<iframe width="100%"  height="370px" title="Iframe Example" src="'+E("url")+'">',"</iframe>")),e.add(t(),"progress","fas fa-percentage","xypp-more-bbcode.forum.container.progress",P("[pbar]"+E("title")+",51%,"+E("simple")+",black,red,pink,1,70,5,40"))})),(0,n.extend)(L().prototype,["oncreate","onupdate"],V),(0,n.extend)(Y().prototype,"oncreate",(function(){(0,n.extend)(this.attrs,"surround",V.bind(this))}))}(e,t),function(e,t){e.group(t(),"embed","fas fa-sitemap","xypp-more-bbcode.forum.embed.title",(function(e){var t=y(100,100);e.add(t(),"cloud","fas fa-cloud","xypp-more-bbcode.forum.embed.cloud",X),e.add(t(),"down","fas fa-download","xypp-more-bbcode.forum.embed.down",j('[down link="'+E("url")+'" size="'+E("size")+'" name="'+E("file")+'"]')),e.add(t(),"audio","fas fa-file-audio","xypp-more-bbcode.forum.embed.audio",j('[audio mp3="'+E("url")+'"]')),e.add(t(),"clip","fas fa-file-video","xypp-more-bbcode.forum.embed.clip",j('[clip mp4="'+E("url")+'"]'))}))}(e,t),function(e,t){e.group(t(),"xx2see","fas fa-eye","xypp-more-bbcode.forum.xx2see.title",(function(e){var t=y(100,100);e.add(t(),"login2see","fas fa-user","xypp-more-bbcode.forum.xx2see.login.title",P("[login]")),e.add(t(),"reply2see","fas fa-reply","xypp-more-bbcode.forum.xx2see.reply.title",P("[reply]")),e.add(t(),"like2see","fas fa-heart","xypp-more-bbcode.forum.xx2see.like.title",P("[like]"))})),(0,n.extend)(L().prototype,"content",(function(){k().session.user&&k().current.matches(te())?$(".reply2see_reply").off("click").on("click",(function(){return ne().replyAction.call(k().current.get("discussion"),!0,!1)})):($(".reply2see_reply").off("click").on("click",(function(){return k().modal.show(ae())})),$(".login2see_login").off("click").on("click",(function(){return k().modal.show(ae())})))}))}(e,t);var r,i=!1,c=!1;(0,n.extend)(x.prototype,"clickEvent",(function(e,t){"group"!==t.type&&M(S("auto-close")||"phone")&&(c=!1,m.redraw())})),(0,n.extend)(a().prototype,"toolbarItems",(function(t){var n,r,a=A(),l=M(S("remove-markdown")),s=S("collect-markdown");a||"none"!=s&&l?i||(e.group(0,"collect","fas fa-box-open","xypp-more-bbcode.forum.collect",(function(){})),i=!0):i&&(e.remove("collect"),i=!1);var u=0;if(a){var p=e.item("collect");p.tags.clear(),Object.keys(t.toObject()).forEach((function(e){if("markdown"!==e){var o=t.getPriority(e),n=t.get(e);t.remove(e),p.tags.collect(0-o,e,n),u=Math.min(u,0-o)}}))}l&&t.has("markdown")&&(e.item("collect").tags.remove("markdown"),"first"===s?e.item("collect").tags.collect(u-1,"markdown",t.get("markdown")):"sub"===s&&e.item("collect").tags.group(u-1,"markdown","fab fa-markdown","xypp-more-bbcode.forum.markdown",(function(e){e.collect(0,"markdown",t.get("markdown"))})),t.remove("markdown")),t.add("xypp-more-bbcode",Z().component({className:"bbcode-more-btn Button Button--icon Button--link",position:"bottom",onclick:function(e){e.currentTarget.blur(),c=!c,m.redraw()},icon:b(c,"fa fa-minus","fa fa-plus")},o().translator.trans("xypp-more-bbcode.forum.name"))),c&&null!=(n=this.attrs)&&null!=(r=n.composer)&&r.editor&&t.add("xypp-more-bbcode-buttons",x.component({tagCollect:e,className:"main-entry",editor:this.attrs.composer.editor,bottom:57}),-5e4)})),(0,n.extend)(a().prototype,["onupdate","oncreate"],(function(){c&&v(this.$(".bbcode-more-btn"),this.$(".main-entry"))})),r={"auto-close":["all","tablet","phone","none"],"pref-markdown":["all","collected","none"],"collect-all":["all","tablet","phone","none"],"remove-markdown":["all","tablet","phone","none"],"collect-markdown":["first","sub","none"]},(0,n.extend)(se().prototype,"settingsItems",(function(e){e.add("xypp-more-bbcode",[m("h2",null,ue("name")),Object.keys(r).map((function(e){var t={};r[e].forEach((function(o){t[o]=ue(e+"."+o)}));var n=S(e)||r[e][0],a=o().forum.attribute("xypp-more-bbcode-"+e);return m(ce(),{label:ue(e+".title"),className:h()("Settings","Settings-"+e)},m("small",{className:"setting-default-value"},b(!!a,ue("preference-default",{default:ue(e+"."+a)}))),m(z(),{options:t,value:n,onchange:function(t){var n={};n["xypp-more-bbcode-"+e]=t,o().session.user.savePreferences(n)}}))}))])}))}),-5e4)})(),module.exports={}})();
//# sourceMappingURL=forum.js.map