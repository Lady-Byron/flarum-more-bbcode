{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@litalino/flarum-more-bbcode/webpack/bootstrap","webpack://@litalino/flarum-more-bbcode/webpack/runtime/compat get default export","webpack://@litalino/flarum-more-bbcode/webpack/runtime/define property getters","webpack://@litalino/flarum-more-bbcode/webpack/runtime/hasOwnProperty shorthand","webpack://@litalino/flarum-more-bbcode/external root \"flarum.core.compat['common/app']\"","webpack://@litalino/flarum-more-bbcode/external root \"flarum.core.compat['common/extend']\"","webpack://@litalino/flarum-more-bbcode/external root \"flarum.core.compat['common/components/TextEditor']\"","webpack://@litalino/flarum-more-bbcode/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@litalino/flarum-more-bbcode/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@litalino/flarum-more-bbcode/external root \"flarum.core.compat['common/Component']\"","webpack://@litalino/flarum-more-bbcode/external root \"flarum.core.compat['common/components/Button']\"","webpack://@litalino/flarum-more-bbcode/external root \"flarum.core.compat['common/components/Tooltip']\"","webpack://@litalino/flarum-more-bbcode/./src/forum/utils/nodeUtil.ts","webpack://@litalino/flarum-more-bbcode/external root \"flarum.core.compat['common/utils/classList']\"","webpack://@litalino/flarum-more-bbcode/./src/forum/utils/hAlignUtil.ts","webpack://@litalino/flarum-more-bbcode/./src/forum/components/buttonBar.tsx","webpack://@litalino/flarum-more-bbcode/external root \"flarum.core.compat['forum/app']\"","webpack://@litalino/flarum-more-bbcode/external root \"flarum.core.compat['common/utils/ItemList']\"","webpack://@litalino/flarum-more-bbcode/./src/forum/helper/tagCollector.ts","webpack://@litalino/flarum-more-bbcode/./src/forum/utils/commonReplaceUtil.ts","webpack://@litalino/flarum-more-bbcode/./src/forum/utils/preferenceUtil.ts","webpack://@litalino/flarum-more-bbcode/./src/forum/utils/styleUtil.ts","webpack://@litalino/flarum-more-bbcode/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@litalino/flarum-more-bbcode/external root \"flarum.core.compat['common/components/Select']\"","webpack://@litalino/flarum-more-bbcode/./src/forum/components/alertPreviewModal.tsx","webpack://@litalino/flarum-more-bbcode/external root \"flarum.core.compat['forum/components/CommentPost']\"","webpack://@litalino/flarum-more-bbcode/external root \"flarum.core.compat['forum/components/ComposerPostPreview']\"","webpack://@litalino/flarum-more-bbcode/./src/forum/tags/utilities.tsx","webpack://@litalino/flarum-more-bbcode/external root \"flarum.core.compat['common/components/TextEditorButton']\"","webpack://@litalino/flarum-more-bbcode/./src/forum/components/cloudPreviewModal.tsx","webpack://@litalino/flarum-more-bbcode/./src/forum/tags/embed.tsx","webpack://@litalino/flarum-more-bbcode/external root \"flarum.core.compat['forum/components/DiscussionPage']\"","webpack://@litalino/flarum-more-bbcode/external root \"flarum.core.compat['forum/utils/DiscussionControls']\"","webpack://@litalino/flarum-more-bbcode/external root \"flarum.core.compat['forum/components/LogInModal']\"","webpack://@litalino/flarum-more-bbcode/external root \"flarum.core.compat['common/components/FieldSet']\"","webpack://@litalino/flarum-more-bbcode/external root \"flarum.core.compat['forum/components/SettingsPage']\"","webpack://@litalino/flarum-more-bbcode/./src/forum/settings.tsx","webpack://@litalino/flarum-more-bbcode/./src/forum/index.ts","webpack://@litalino/flarum-more-bbcode/./src/forum/tags/typography.tsx","webpack://@litalino/flarum-more-bbcode/./src/forum/tags/xx2see.tsx"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/TextEditor'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Tooltip'];","export function showIf(judgement: boolean, vnode: any, def?: any) {\n    return judgement ? vnode : (def || \"\");\n}\nexport function prioritySerial(startValue: number, step: number): () => number {\n    let value = startValue;\n    return () => {\n        const ret = value;\n        value += step;\n        return ret;\n    };\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/classList'];","export default function align(base: JQuery, elem: JQuery) {\n    const parentOffset = base.offsetParent()?.offset()?.left || 0;\n    const realLeft = base.offset()?.left || 0;\n    const screenWid = $(document.body).width() || 0;\n    let targetWidth = elem.width() || 0;\n    let globalOffset = realLeft;\n\n    if (globalOffset + targetWidth > screenWid) {\n        globalOffset = screenWid - targetWidth;\n    }\n    if (globalOffset < 0) globalOffset = 0;\n\n    elem.css({\n        left: globalOffset - parentOffset\n    });\n}","import Component from \"flarum/common/Component\";\nimport Button from \"flarum/common/components/Button\";\nimport Tooltip from \"flarum/common/components/Tooltip\";\nimport TagCollector, { Tags } from \"../helper/tagCollector\";\nimport { showIf } from \"../utils/nodeUtil\";\nimport classList from \"flarum/common/utils/classList\";\nimport align from \"../utils/hAlignUtil\";\nimport Mithril from \"mithril\";\n\n// 每行按钮高度（用于子按钮定位）\nconst heightPreRow = 36;\n\nexport default class buttonBar extends Component<{\n  tagCollect: TagCollector;\n  editor: any;            // Flarum EditorDriver（RTE/纯文本均可）\n  rows?: number;\n  className?: string;\n  bottom?: number;\n}> {\n  selectedSub: string = \"\";\n\n  // —— 仅在本文件内的小工具：包裹/插入 —— //\n  private applyStyleInline = (style: any) => {\n    const ed: any = this.attrs.editor;\n    const prefix = style?.prefix ?? \"\";\n    const suffix = style?.suffix ?? \"\";\n\n    // 优先走 EditorDriver（RTE 与纯文本都实现了这套接口）\n    if (ed?.getSelectionRange && ed?.getValue && ed?.replaceSelection) {\n      const { start, end } = ed.getSelectionRange();\n      const value: string = ed.getValue();\n      const selected = value.slice(start, end);\n      const text = prefix + selected + suffix;\n\n      ed.replaceSelection(text);\n      ed.focus?.();\n\n      // 如果没有选中文本且存在 suffix，把光标移到两端标记中间\n      if (!selected && suffix) {\n        const pos = start + prefix.length;\n        ed.setSelectionRange?.(pos, pos);\n      }\n      return;\n    }\n\n    // 兜底：直接操作 textarea（纯文本旧环境）\n    const ta = document.querySelector<HTMLTextAreaElement>('.ComposerBody textarea');\n    if (ta) {\n      const s = ta.selectionStart ?? ta.value.length;\n      const e = ta.selectionEnd ?? ta.value.length;\n      const selected = ta.value.slice(s, e);\n      const text = prefix + selected + suffix;\n      ta.setRangeText(text, s, e, 'end');\n      ta.dispatchEvent(new Event('input', { bubbles: true }));\n      ta.focus();\n      if (!selected && suffix) {\n        const pos = s + prefix.length;\n        ta.setSelectionRange(pos, pos);\n      }\n    }\n  };\n\n  view() {\n    const rows = this.attrs.rows || 1;\n    const tags = this.attrs.tagCollect.get();\n    const groups = tags.filter((tag) => tag.type === \"group\");\n    const offset = (this.attrs.bottom || 0) + 3;\n\n    return (\n      <div className={classList(\"ButtonBar\", this.attrs.className)} style={`bottom:${offset}px;`}>\n        {this.getTags(tags, rows)}\n        {groups.map((group) =>\n          buttonBar.component({\n            editor: this.attrs.editor,\n            tagCollect: group.tags,\n            className: \"SubButtons\" + showIf(this.selectedSub === group.name, \" show\", \"\"),\n            rows: group.rows,\n            bottom: rows * heightPreRow,\n          })\n        )}\n      </div>\n    );\n  }\n\n  onupdate(vnode: any): void {\n    super.onupdate(vnode);\n    if (this.selectedSub) {\n      const base = $(this.element).find(\".Button.selected\");\n      const elem = $(this.element).children(\".show\");\n      align(base, elem);\n    }\n  }\n\n  getTags(tags: Tags[], rows: number) {\n    const ret: (Mithril.ClassComponent | JSX.Element)[][] = [[]];\n    const preRow = Math.floor((tags.length + rows - 1) / rows);\n    let currentRow = 0;\n\n    for (let i = 0; i < tags.length; i++) {\n      ret[currentRow].push(this.getTagComponent(tags[i]));\n      if ((i + 1) % preRow === 0) {\n        currentRow++;\n        ret.push([]);\n      }\n    }\n    return ret.map((row) => <div className=\"ButtonBar-row\">{row}</div>);\n  }\n\n  getTagComponent(tag: Tags) {\n    if (tag.type === \"space\") return <div className=\"ButtonBar-space\"></div>;\n    if (tag.type === \"collect\") return tag.component;\n\n    let clsName = \"Button Button--link\";\n    if (tag.type === \"group\") clsName += \" GroupBtn\";\n    if (typeof tag.icon === \"string\") clsName += \" Button--icon\";\n    if (tag.name === this.selectedSub) clsName += \" selected\";\n\n    if (!tag.icon) {\n      return (\n        <Button className={clsName} onclick={this.clickEventWarper(tag)}>\n          {tag.tooltip}\n        </Button>\n      );\n    } else if (typeof tag.icon === \"string\") {\n      return (\n        <Tooltip text={tag.tooltip} position=\"bottom\">\n          <Button className={clsName} icon={tag.icon} onclick={this.clickEventWarper(tag)} />\n        </Tooltip>\n      );\n    } else if (typeof tag.icon === \"function\") {\n      return (\n        <Tooltip text={tag.tooltip} position=\"bottom\">\n          <Button className={clsName} onclick={this.clickEventWarper(tag)}>\n            {tag.icon()}\n          </Button>\n        </Tooltip>\n      );\n    } else {\n      return (\n        <Tooltip text={tag.tooltip} position=\"bottom\">\n          <Button className={clsName} onclick={this.clickEventWarper(tag)}>\n            {tag.icon.component.component(tag.icon.attrs)}\n          </Button>\n        </Tooltip>\n      );\n    }\n  }\n\n  clickEventWarper(tag: Tags) {\n    return ((event: MouseEvent) => {\n      (event.currentTarget as HTMLElement).blur();\n      this.clickEvent(tag);\n    }).bind(this);\n  }\n\n  clickEvent(tag: Tags) {\n    if (tag.type === \"group\") {\n      this.selectedSub = tag.name;\n      m.redraw();\n      return;\n    }\n    if (tag.type !== \"button\") return;\n\n    if (typeof tag.style !== \"function\") {\n      this.applyStyleInline(tag.style as any);\n    } else {\n      const data = tag.style();\n      if (data instanceof Promise) {\n        data.then((style) => style && this.applyStyleInline(style as any));\n      } else {\n        data && this.applyStyleInline(data as any);\n      }\n    }\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/ItemList'];","import { NestedStringArray } from \"@askvortsov/rich-icu-message-formatter\";\nimport app from \"flarum/forum/app\";\nimport ItemList from \"flarum/common/utils/ItemList\";\nimport Component from \"flarum/common/Component\";\nimport Mithril from \"mithril\";\n\nexport interface StyleArgs {\n    prefix: string;\n    suffix: string;\n    blockPrefix: string;\n    blockSuffix: string;\n    multiline: boolean;\n    replaceNext: string;\n    prefixSpace: boolean;\n    scanFor: string;\n    surroundWithNewlines: boolean;\n    orderedList: boolean;\n    unorderedList: boolean;\n    trimFirst: boolean;\n}\nexport type TooltipKeyType = string | {\n    key: string,\n    params: any\n};\nexport type IconType = string | false | {\n    component: any,\n    attrs: any\n} | (() => Mithril.ClassComponent | JSX.Element);\nexport type StyleType = Partial<StyleArgs> | (() => Partial<StyleArgs>) | (() => Promise<Partial<StyleArgs>>) | (() => void);\n\n//Tags\nexport type TagButton = {\n    type: \"button\",\n    icon: IconType,\n    tooltip: NestedStringArray,\n    name: string,\n    style: StyleType\n}\nexport type TagCollected = {\n    type: \"collect\",\n    name: string,\n    component: Mithril.ClassComponent | JSX.Element\n}\nexport type TagButtonGroup = {\n    type: \"group\",\n    icon: IconType,\n    tooltip: NestedStringArray,\n    tags: TagCollector,\n    name: string,\n    rows: number\n}\nexport type TagSpace = {\n    type: \"space\"\n}\nexport type Tags = TagButton | TagButtonGroup | TagSpace | TagCollected;\nexport default class TagCollector {\n    public tags: ItemList<(Tags)> = new ItemList();\n    spaceKey = 0;\n    private getTranslation(key: TooltipKeyType) {\n        return typeof key === \"string\" ? app.translator.trans(key) : app.translator.trans(key.key, key.params);\n    }\n    public add(priority: number, name: string, icon: IconType, tooltipKey: TooltipKeyType, style: StyleType) {\n        this.tags.add(name, {\n            type: \"button\",\n            name,\n            icon,\n            tooltip: this.getTranslation(tooltipKey),\n            style\n        }, priority);\n        return this;\n    }\n    public collect(priority: number, name: string, component: Mithril.ClassComponent | JSX.Element) {\n        this.tags.add(name, {\n            type: \"collect\",\n            name,\n            component\n        }, priority);\n    }\n    public space(priority: number) {\n        this.tags.add(\"space-\" + (this.spaceKey++), {\n            type: \"space\"\n        }, priority);\n        return this;\n    }\n    public group(priority: number, name: string, icon: IconType, tooltipKey: TooltipKeyType, callback: (tags: TagCollector) => void, rows: number = 1) {\n        const newGroup = new TagCollector();\n        callback(newGroup);\n        this.tags.add(name, {\n            type: \"group\",\n            name,\n            icon: icon,\n            tooltip: this.getTranslation(tooltipKey),\n            tags: newGroup,\n            rows\n        }, priority);\n        return newGroup;\n    }\n\n    public item(key: string): Tags {\n        return this.tags.get(key);\n    }\n    public clear() {\n        Object.keys(this.tags.toObject()).forEach(k => this.tags.remove(k));\n    }\n    public remove(key: string) {\n        this.tags.remove(key);\n    }\n    public get() {\n        const arr = this.tags.toArray();\n        const disabled: Record<string, boolean> = app.forum.attribute(\"bbcode-disable\");\n        return arr.filter(item => !disabled[item.itemName]).reverse();\n    }\n}","import app from \"flarum/forum/app\";\nexport type COMMON_KEY = \"describe\" | \"title\" | \"text\" | \"Put\" | \"url\" | \"size\" | \"file\" | \"any\" | \"column\" | \"simple\";\nexport default function common(key: COMMON_KEY): string {\n    return app.translator.trans(\"xypp-more-bbcode.forum.common.\" + key) + \"\"\n}","import app from \"flarum/forum/app\";\nimport { StyleType } from \"../helper/tagCollector\";\n\nexport function getValue<T>(key: string): T {\n    let value = (app.session?.user?.preferences() || {})[\"xypp-more-bbcode-\" + key] as T | null | undefined;\n    if (!value) {\n        value = app.forum.attribute<T>(\"xypp-more-bbcode-\" + key);\n    }\n    return value;\n}\n\nexport function selectBBCodeOrNormal(bbcode: StyleType, normal: StyleType) {\n    return () => {\n        if (prefMarkdown()) {\n            return normal;\n        }\n        return bbcode;\n    };\n}\n\nexport function prefMarkdown() {\n    const pref: \"all\" | \"none\" | \"collected\" = getValue(\"pref-markdown\");\n    if (pref === \"all\") return true;\n    if (pref === \"none\") return false;\n    return collectAll();\n}\n\nexport function autoClose(): boolean {\n    const close = getValue(\"auto-close\") || \"phone\";\n    return checkDevice(close);\n}\nexport function collectAll(): boolean {\n    return checkDevice(getValue(\"collect-all\"));\n}\nexport function removeMd(): boolean {\n    return checkDevice(getValue(\"remove-markdown\"));\n}\nexport function collectMarkdown(): \"none\" | \"first\" | \"sub\" {\n    return getValue(\"collect-markdown\");\n}\n\nfunction checkDevice(target: \"none\" | \"all\" | \"phone\" | \"tablet\" | any): boolean {\n    if (target == \"none\") return false;\n    if (target == \"all\") return true;\n    const current = app.screen();\n    if (target === 'phone' && current === \"phone\") return true;\n    if (target === \"tablet\" && (current === \"phone\" || current === \"tablet\")) return true;\n    return false;\n}","import { StyleArgs } from \"../helper/tagCollector\";\n\nexport function merge(...args: Partial<StyleArgs>[]){\n    return Object.assign({}, ...args);\n}\nexport function pair(p: string, s?: string, trim: boolean = true): Partial<StyleArgs> {\n    if (!s) s = p;\n    return { prefix: p, suffix: s, trimFirst: trim };\n}\nexport function prefix(p: string, trim: boolean = true): Partial<StyleArgs> {\n    return { prefix: p, trimFirst: trim };\n}\n\nexport function bbcode(code: string, trim: boolean = false) {\n    const regex = /\\[([a-zA-Z0-9_-]+)/.exec(code);\n    if (!regex) {\n        return {}\n    }\n    const end = regex[1];\n    return pair(code, `[/${end}]`, trim);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Select'];","import Modal, { IInternalModalAttrs } from \"flarum/common/components/Modal\";\nimport app from \"flarum/forum/app\";\nimport { StyleArgs } from \"../helper/tagCollector\";\nimport Select from \"flarum/common/components/Select\"\nimport { bbcode } from \"../utils/styleUtil\";\nimport Button from \"flarum/common/components/Button\";\nfunction _trans(key: string, params?: any): string {\n    const dat = app.translator.trans(\"xypp-more-bbcode.forum.alert.\" + key, params);\n    if (Array.isArray(dat)) return dat.join(\"\");\n    return dat;\n}\nexport default class alertPreviewModal extends Modal<{\n    onsubmit: (style: Partial<StyleArgs>) => void;\n    oncancel: () => void;\n} & IInternalModalAttrs> {\n    done: boolean = false;\n    typesOpt: Record<string, string> = {};\n    availableMap: Record<string, string[]> = {\n        \"success\": [\"a\", \"b\", \"c\", \"d\"],\n        \"warning\": [\"a\", \"b\", \"c\", \"d\"],\n        \"error\": [\"a\", \"b\", \"c\", \"d\"],\n        \"notice\": [\"a\", \"b\", \"c\", \"d\"],\n        \"basic\": [\"a\"],\n        \"custom\": [\"a\", \"b\"],\n    };\n    colorMap: Record<string, string[]> = {\n        \"success\": [\"green\", \"white\", \"green\"],\n        \"error\": [\"red\", \"white\", \"red\"],\n        \"notice\": [\"teal\", \"white\", \"teal\"],\n        \"warning\": [\"darkorange\", \"white\", \"darkorange\"],\n        \"custom\": [\"red\", \"white\", \"red\"],\n    };\n    available: string[] = [\"a\", \"b\", \"c\", \"d\"];\n    type: string = \"notice\";\n    style: string = \"a\";\n    public oninit(vnode: any) {\n        super.oninit(vnode);\n        this.typesOpt = {\n            \"success\": _trans(\"type.success\") + \"\",\n            \"warning\": _trans(\"type.warning\") + \"\",\n            \"error\": _trans(\"type.error\") + \"\",\n            \"notice\": _trans(\"type.notice\") + \"\",\n            \"basic\": _trans(\"type.basic\") + \"\",\n            \"custom\": _trans(\"type.custom\") + \"\",\n        };\n    }\n    public className() {\n        return \"alertPreviewModal Modal--small\";\n    }\n    public title() {\n        return _trans(\"title\");\n    }\n    content() {\n        const availableDict: Record<string, string> = {};\n        this.available.forEach(v => {\n            availableDict[v] = v;\n        });\n        return <div className=\"Modal-body\">\n            <div className=\"Form-group\">\n                <label for=\"xypp-more-bbcode-alert-type\">\n                    {_trans(\"type.label\")}\n                </label>\n                <Select options={this.typesOpt} value={this.type} onchange={((e: string) => {\n                    this.type = e;\n                    this.available = this.availableMap[e];\n                }).bind(this)}></Select>\n            </div>\n            <div className=\"Form-group\">\n                <label for=\"xypp-more-bbcode-alert-type\">\n                    {_trans(\"style\")}\n                </label>\n                <Select options={availableDict} value={this.style} onchange={((e: string) => {\n                    this.style = e;\n                }).bind(this)}></Select>\n            </div>\n            <div className=\"bbcode-alert-preview\">\n\n            </div>\n            <Button className=\"Button Button--primary\" type=\"submit\">{_trans(\"insert\")}</Button>\n        </div>;\n    }\n    generateStyle(): Partial<StyleArgs> {\n        const style = this.style;\n        const type = this.type;\n        if (this.type === \"custom\") {\n            if (this.style === \"a\") {\n                return bbcode(\n                    `[acustom]${this.colorMap.custom.join(\",\")},${_trans(\"defaults.content\", { type, style })}`\n                );\n            } else if (this.style === \"b\") {\n                return bbcode(\n                    `[bcustom]title=${_trans(\"defaults.content\", { type, style })} font=${this.colorMap.custom[0]} bg=${this.colorMap.custom[1]} border=${this.colorMap.custom[2]}`\n                )\n            } else return {};\n        }\n        switch (this.style) {\n            case \"a\": return bbcode(\n                `[a${this.type}]${_trans(\"defaults.content\", { type, style })}`\n            );\n            case \"b\": return bbcode(\n                `[b${this.type}]${_trans(\"defaults.content\", { type, style })}`\n            );\n            case \"c\": return bbcode(\n                `[c${this.type}]${this.colorMap[type].join(\",\")},${_trans(\"defaults.title\")},${_trans(\"defaults.content\", { type, style })}`\n            );\n            case \"d\": return bbcode(\n                `[d${this.type} title=${_trans(\"defaults.title\")} font=${this.colorMap.custom[0]} bg=${this.colorMap.custom[1]} border=${this.colorMap.custom[2]}]${_trans(\"defaults.content\", { type, style })}`\n            );\n            default:\n                return {};\n        }\n    }\n    generateBBCode(): string {\n        const style = this.generateStyle();\n        return (style.prefix + \"\") + (style.suffix || \"\");\n    }\n    onupdate(vnode: any): void {\n        super.onupdate(vnode);\n        //@ts-ignore\n        s9e.TextFormatter.preview(\n            this.generateBBCode(),\n            this.$(\".bbcode-alert-preview\")[0]\n        );\n    }\n    onsubmit(e: SubmitEvent): void {\n        e.preventDefault();\n        this.done = true;\n        this.attrs.onsubmit(this.generateStyle());\n        app.modal.close();\n    }\n    onbeforeremove(vnode: any): Promise<void> | void {\n        if (this.done) return;\n        this.attrs.oncancel();\n    }\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/CommentPost'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/ComposerPostPreview'];","import app from \"flarum/forum/app\";\nimport alertPreviewModal from \"../components/alertPreviewModal\";\nimport TagCollector, { StyleArgs } from \"../helper/tagCollector\";\nimport { prioritySerial } from \"../utils/nodeUtil\";\nimport { bbcode, merge, pair, prefix } from \"../utils/styleUtil\";\nimport CommentPost from \"flarum/forum/components/CommentPost\";\nimport ComposerPostPreview from \"flarum/forum/components/ComposerPostPreview\";\nimport { extend } from \"flarum/common/extend\";\nimport common from \"../utils/commonReplaceUtil\";\nimport { selectBBCodeOrNormal } from \"../utils/preferenceUtil\";\nexport default function addUtilitiesTags(tags: TagCollector, priority: () => number) {\n    //Containers\n    tags.group(priority(), \"container\",\n        \"fas fa-square\",\n        \"xypp-more-bbcode.forum.container.title\", (tags) => {\n            const priority = prioritySerial(100, 100);\n            //Table\n            tags.add(priority(), \"table\",\n                \"fas fa-table\",\n                \"xypp-more-bbcode.forum.container.table\",\n                selectBBCodeOrNormal(\n                    prefix(`\n[TABLE]\n    [THEAD]\n        [TH]${common(\"column\")}[TH]\n        [TH]${common(\"column\")}[TH]\n        [TH]${common(\"any\")}[TH]\n    [/THEAD]\n    [TBODY]\n        [TR]\n            [TD]${common(\"text\")}[TD]\n            [TD]${common(\"text\")}[TD]\n            [TD]${common(\"any\")}[TD]\n        [/TR]\n    [/TBODY]\n[/TABLE]\n`),\n                    prefix(`\n| ${common(\"column\")} | ${common(\"column\")} | ${common(\"column\")} | ${common(\"column\")} |\n|---|---|---|---|\n| ${common(\"any\")} | ${common(\"any\")} | ${common(\"any\")} | ${common(\"any\")} |\n`)\n                ));\n            //Quote\n            tags.add(priority(), \"quote\",\n                \"fas fa-quote-right\",\n                \"xypp-more-bbcode.forum.container.quote\",\n                selectBBCodeOrNormal(\n                    bbcode(\"[quote]\"),\n                    merge(prefix(\">\"), {\n                        multiline: true,\n                        surroundWithNewlines: true\n                    })));\n            //Details\n            tags.add(priority(), \"details\",\n                \"fas fa-info-circle\",\n                \"xypp-more-bbcode.forum.container.details\",\n                merge(bbcode(\"[details=\\\"TITLE\\\"] CONTENT \"), {\n                    blockPrefix: '[/details]'\n                }));\n            //Tabs\n            tags.add(priority(), \"tabs\",\n                \"fas fa-columns\",\n                \"xypp-more-bbcode.forum.container.tabs\",\n                prefix(`\n[tabs]\n[tab=\\\"${common(\"column\")}\\\"]${common(\"text\")}[/tab]\n[tab=\\\"${common(\"any\")}\\\"]${common(\"text\")}[/tab]\n[/tabs]\n`));\n            //Alert\n            tags.add(priority(), \"alert\",\n                \"fas fa-exclamation-triangle\",\n                \"xypp-more-bbcode.forum.container.alert\",\n                makeAlert\n            );\n\n            tags.space(priority());\n\n            //IFrame\n            tags.add(priority(), \"iframe\",\n                \"fas fa-window-maximize\",\n                \"xypp-more-bbcode.forum.container.iframe\",\n                pair('<iframe width=\"100%\"  height=\"370px\" title=\"Iframe Example\" src=\"' + common(\"url\") + '\">', '</iframe>')\n            )\n\n            //Progress\n            tags.add(priority(), \"progress\",\n                \"fas fa-percentage\",\n                \"xypp-more-bbcode.forum.container.progress\",\n                bbcode(`[pbar]${common(\"title\")},51%,${common(\"simple\")},black,red,pink,1,70,5,40`)\n            );\n        }\n    );\n    // RegTab\n    extend(CommentPost.prototype, [\"oncreate\", \"onupdate\"], createTab);\n    extend(ComposerPostPreview.prototype, \"oncreate\", function (this: ComposerPostPreview) {\n        extend(this.attrs as any, \"surround\", createTab.bind(this));\n    });\n}\nfunction makeAlert() {\n    return new Promise<Partial<StyleArgs>>((resolve, reject) => {\n        app.modal.show(alertPreviewModal, {\n            onsubmit: resolve,\n            oncancel: reject\n        });\n    })\n}\n\n\n/**\n * Tab Id Assigner\n * Copy from Litalino/flarum-more-bbcode\n */\n\nlet tabId = 0;\nfunction createTab(this: CommentPost | ComposerPostPreview) {\n    const containers = this.$(\".tabs\");\n    containers.each((i, container) => {\n        const $container = $(container);\n\n        if ($container.find('input[type=\"radio\"][name]').length) return;\n        const $inputs = $container.find('.tabs-title > .tab > input[type=\"radio\"]');\n\n        if (!$inputs.length) return;\n\n        const $items = $container.find(\".tab\");\n        const num = tabId++;\n\n        $inputs.attr(\"name\", `tab-group-${num}`);\n\n        if (!$inputs.is(\"[checked]\"))\n            $inputs[0].setAttribute(\"checked\", \"checked\");\n\n        $items.each((i, item) => {\n            const $item = $(item);\n            const id = `tab-${num}-${++i}`;\n\n            $item.find('input[type=\"radio\"]').attr(\"id\", id);\n            $item.find(\"label\").attr(\"for\", id);\n        });\n    });\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/TextEditorButton'];","import Modal, { IInternalModalAttrs } from \"flarum/common/components/Modal\";\nimport app from \"flarum/forum/app\";\nimport { StyleArgs } from \"../helper/tagCollector\";\nimport Select from \"flarum/common/components/Select\"\nimport { bbcode } from \"../utils/styleUtil\";\nimport Button from \"flarum/common/components/Button\";\nimport common from \"../utils/commonReplaceUtil\";\nfunction _trans(key: string, params?: any): string {\n    const dat = app.translator.trans(\"xypp-more-bbcode.forum.cloud.\" + key, params);\n    if (Array.isArray(dat)) return dat.join(\"\");\n    return dat;\n}\nexport default class cloudPreviewModal extends Modal<{\n    onsubmit: (style: Partial<StyleArgs>) => void;\n    oncancel: () => void;\n} & IInternalModalAttrs> {\n    done: boolean = false;\n    opts: Record<string, string> = {};\n    type: string = \"other\";\n    public oninit(vnode: any) {\n        super.oninit(vnode);\n        this.opts = app.forum.attribute(\"bbcode-cloud\");\n    }\n    public className() {\n        return \"alertPreviewModal Modal--small\";\n    }\n    public title() {\n        return _trans(\"title\");\n    }\n    content() {\n        return <div className=\"Modal-body\">\n            <div className=\"Form-group\">\n                <label for=\"xypp-more-bbcode-cloud-type\">\n                    {_trans(\"type.label\")}\n                </label>\n                <Select options={this.opts} value={this.type} onchange={((e: string) => {\n                    this.type = e;\n                }).bind(this)}></Select>\n            </div>\n            <div className=\"bbcode-cloud-preview\">\n\n            </div>\n            <Button className=\"Button Button--primary\" type=\"submit\">{_trans(\"insert\")}</Button>\n        </div>;\n    }\n    generateStyle(): Partial<StyleArgs> {\n        return bbcode(`[cloud type=\"${this.type}\" title=\"${common(\"title\")}\" url=\"${common(\"url\")}\"]${_trans(\"content.defaults\")}`);\n    }\n    generateBBCode(): string {\n        const style = this.generateStyle();\n        return (style.prefix + \"\") + (style.suffix || \"\");\n    }\n    onupdate(vnode: any): void {\n        super.onupdate(vnode);\n        //@ts-ignore\n        s9e.TextFormatter.preview(\n            this.generateBBCode(),\n            this.$(\".bbcode-cloud-preview\")[0]\n        );\n    }\n    onsubmit(e: SubmitEvent): void {\n        e.preventDefault();\n        this.done = true;\n        this.attrs.onsubmit(this.generateStyle());\n        app.modal.close();\n    }\n    onbeforeremove(vnode: any): Promise<void> | void {\n        if (this.done) return;\n        this.attrs.oncancel();\n    }\n}","import app from \"flarum/forum/app\";\nimport TagCollector, { StyleArgs } from \"../helper/tagCollector\";\nimport { prioritySerial } from \"../utils/nodeUtil\";\nimport cloudPreviewModal from \"../components/cloudPreviewModal\";\nimport { bbcode, prefix } from \"../utils/styleUtil\";\nimport common from \"../utils/commonReplaceUtil\";\n\nexport default function addEmbedTags(tags: TagCollector, priority: () => number) {\n    tags.group(priority(), \"embed\",\n        \"fas fa-sitemap\",\n        \"xypp-more-bbcode.forum.embed.title\",\n        (tags) => {\n            const priority = prioritySerial(100, 100);\n            //Cloud\n            tags.add(priority(), \"cloud\",\n                \"fas fa-cloud\",\n                \"xypp-more-bbcode.forum.embed.cloud\",\n                makeCloud\n            );\n            //Down\n            tags.add(priority(), \"down\",\n                \"fas fa-download\",\n                \"xypp-more-bbcode.forum.embed.down\",\n                prefix(`[down link=\"${common(\"url\")}\" size=\"${common(\"size\")}\" name=\"${common(\"file\")}\"]`)\n            );\n            //Audio\n            tags.add(priority(), \"audio\",\n                \"fas fa-file-audio\",\n                \"xypp-more-bbcode.forum.embed.audio\",\n                prefix(`[audio mp3=\"${common(\"url\")}\"]`)\n            );\n            //Clip\n            tags.add(priority(), \"clip\",\n                \"fas fa-file-video\",\n                \"xypp-more-bbcode.forum.embed.clip\",\n                prefix(`[clip mp4=\"${common(\"url\")}\"]`)\n            );\n\n\n        }\n    );\n\n}\nfunction makeCloud() {\n    return new Promise<Partial<StyleArgs>>((resolve, reject) => {\n        app.modal.show(cloudPreviewModal, {\n            onsubmit: resolve,\n            oncancel: reject\n        });\n    })\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/utils/DiscussionControls'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/LogInModal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/FieldSet'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/SettingsPage'];","import app from 'flarum/common/app';\nimport Select from 'flarum/common/components/Select';\nimport FieldSet from \"flarum/common/components/FieldSet\"\nimport { extend } from \"flarum/common/extend\";\nimport SettingsPage from \"flarum/forum/components/SettingsPage\";\nimport classList from 'flarum/common/utils/classList';\nimport { showIf } from './utils/nodeUtil';\nimport { getValue } from './utils/preferenceUtil';\n\nfunction _trans(key: string, params?: any): string {\n    const dat = app.translator.trans(\"xypp-more-bbcode.forum.\" + key, params);\n    if (Array.isArray(dat)) return dat.join(\"\");\n    return dat;\n}\nexport default function regSetting() {\n    const config: Record<string, string[]> = {\n        \"auto-close\": [\"all\", \"tablet\", \"phone\", \"none\"],\n        \"pref-markdown\": [\"all\", \"collected\", \"none\"],\n        \"collect-all\": [\"all\", \"tablet\", \"phone\", \"none\"],\n        \"remove-markdown\": [\"all\", \"tablet\", \"phone\", \"none\"],\n        \"collect-markdown\": [\"first\", \"sub\", \"none\"],\n    }\n    extend(SettingsPage.prototype, 'settingsItems', function (items) {\n        items.add(\n            'xypp-more-bbcode', [\n            <h2>{_trans(\"name\")}</h2>,\n            Object.keys(config).map((key) => {\n                const opts: Record<string, string> = {};\n                config[key].forEach(k => { opts[k] = _trans(`${key}.${k}`) });\n                const value = getValue(key) || config[key][0];\n                const fm = app.forum.attribute(\"xypp-more-bbcode-\" + key);\n                return <FieldSet label={_trans(key + \".title\")} className={classList(\"Settings\", \"Settings-\" + key)}>\n                    <small className='setting-default-value'>{showIf(!!fm, _trans(\"preference-default\", { \"default\": _trans(`${key}.${fm}`) }))}</small>\n                    <Select\n                        options={opts}\n                        value={value}\n                        onchange={(value: string) => {\n                            const saveObj: Record<string, string> = {}\n                            saveObj[\"xypp-more-bbcode-\" + key] = value;\n                            app.session.user!.savePreferences(saveObj);\n                        }}\n                    />\n                </FieldSet>\n            })]\n        );\n    })\n}","/*\n * This file is part of Xypp/more-bbcode.\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\n\nimport app from 'flarum/common/app';\nimport { extend } from 'flarum/common/extend';\nimport TextEditor from \"flarum/common/components/TextEditor\";\nimport buttonBar from './components/buttonBar';\nimport TagCollector, { TagButtonGroup, Tags } from './helper/tagCollector';\nimport addTypographyButtons from './tags/typography';\nimport addUtilitiesTags from './tags/utilities';\nimport TextEditorButton from \"flarum/common/components/TextEditorButton\";\nimport { prioritySerial, showIf } from './utils/nodeUtil';\nimport addEmbedTags from './tags/embed';\nimport { addXX2SeeTags } from './tags/xx2see';\nimport align from './utils/hAlignUtil';\nimport regSetting from './settings';\nimport { autoClose, collectAll, collectMarkdown, removeMd } from './utils/preferenceUtil';\n\napp.initializers.add('xypp/more-bbcode', () => {\n  const tags = new TagCollector();\n  const priority = prioritySerial(100, 100);\n  addTypographyButtons(tags, priority);\n  addUtilitiesTags(tags, priority);\n  addEmbedTags(tags, priority);\n  addXX2SeeTags(tags, priority);\n  let hasAddCollectBtn = false;\n  let hasAddMarkdownGrp = false;\n  let showMoreBBcodeButtons = false;\n  extend(buttonBar.prototype, \"clickEvent\", function (this: buttonBar, val: any, tag: Tags) {\n    if (tag.type === \"group\") return;\n    if (autoClose()) {\n      showMoreBBcodeButtons = false;\n      m.redraw();\n    }\n  })\n  extend(TextEditor.prototype, \"toolbarItems\", function (this: TextEditor, items) {\n    const collect_all = collectAll();\n    const remove_markdown = removeMd();\n    const collect_markdown = collectMarkdown();\n\n    //Add Collect Group\n    if (collect_all || (collect_markdown != \"none\" && remove_markdown)) {\n      if (!hasAddCollectBtn) {\n        tags.group(0, \"collect\", \"fas fa-box-open\", \"xypp-more-bbcode.forum.collect\", () => { });\n        hasAddCollectBtn = true;\n      }\n    } else {\n      if (hasAddCollectBtn) {\n        tags.remove(\"collect\");\n        hasAddCollectBtn = false;\n      }\n    }\n\n    let minPriority = 0;\n    if (collect_all) {\n      const collect = tags.item(\"collect\") as TagButtonGroup;\n      collect.tags.clear();\n      Object.keys(items.toObject()).forEach(function (key) {\n        if (key === \"markdown\") return;\n        const p = items.getPriority(key);\n        const item = items.get(key);\n        items.remove(key);\n        collect.tags.collect(0 - p, key, item);\n        minPriority = Math.min(minPriority, 0 - p);\n      });\n    }\n\n    //Add Markdown Group\n    if (remove_markdown && items.has(\"markdown\")) {\n      (tags.item(\"collect\") as TagButtonGroup).tags.remove(\"markdown\");\n      if (collect_markdown === \"first\") {\n        (tags.item(\"collect\") as TagButtonGroup).tags.collect(minPriority - 1, \"markdown\", items.get(\"markdown\"));\n      } else if (collect_markdown === \"sub\") {\n        (tags.item(\"collect\") as TagButtonGroup).tags.group(minPriority - 1, \"markdown\", \"fab fa-markdown\", \"xypp-more-bbcode.forum.markdown\", g_tags => {\n          g_tags.collect(0, \"markdown\", items.get(\"markdown\"));\n        });\n      }\n      items.remove(\"markdown\");\n    }\n\n\n    items.add(\"xypp-more-bbcode\", TextEditorButton.component({\n      className: \"bbcode-more-btn Button Button--icon Button--link\",\n      position: \"bottom\",\n      onclick: (e: any) => {\n        e.currentTarget.blur();\n        showMoreBBcodeButtons = !showMoreBBcodeButtons;\n        m.redraw();\n      },\n      icon: showIf(showMoreBBcodeButtons, \"fa fa-minus\", \"fa fa-plus\")\n    }, app.translator.trans(\"xypp-more-bbcode.forum.name\")));\n    if (showMoreBBcodeButtons && (this.attrs as any)?.composer?.editor)\n      items.add(\"xypp-more-bbcode-buttons\", buttonBar.component({\n        tagCollect: tags,\n        className: \"main-entry\",\n        editor: (this.attrs as any).composer.editor,\n        bottom: 57\n      }), -50000);\n  });\n  extend(TextEditor.prototype, [\"onupdate\", \"oncreate\"], function (this: TextEditor) {\n    if (!showMoreBBcodeButtons) return;\n    const btn = this.$(\".bbcode-more-btn\");\n    const elem = this.$(\".main-entry\");\n    align(btn, elem);\n  });\n  regSetting();\n}, -50000);\n","import TagCollector from \"../helper/tagCollector\";\nimport common from \"../utils/commonReplaceUtil\";\nimport { prioritySerial } from \"../utils/nodeUtil\";\nimport { selectBBCodeOrNormal } from \"../utils/preferenceUtil\";\nimport { bbcode, merge, pair, prefix } from \"../utils/styleUtil\";\n\nexport default function addTypographyButtons(tags: TagCollector, priority: () => number) {\n    // Fonts\n    tags.group(priority(), \"fonts\",\n        \"fas fa-bold\",\n        \"xypp-more-bbcode.forum.fonts.title\", (tags) => {\n            const priority = prioritySerial(100, 100);\n            //Bold\n            tags.add(priority(), \"bold\",\n                \"fas fa-bold\",\n                \"xypp-more-bbcode.forum.fonts.bold\",\n                selectBBCodeOrNormal(bbcode(\"[b]\"), pair(\"**\")));\n            //Italic\n            tags.add(priority(), \"italic\",\n                \"fas fa-italic\",\n                \"xypp-more-bbcode.forum.fonts.italic\",\n                selectBBCodeOrNormal(bbcode(\"[i]\"), pair(\"*\")));\n            // Strike through\n            tags.add(priority(), \"strike-through\",\n                \"fas fa-strikethrough\",\n                \"xypp-more-bbcode.forum.fonts.strike_through\",\n                selectBBCodeOrNormal(bbcode(\"[del]\"), pair(\"~~\")));\n            // Underline\n            tags.add(priority(), \"underline\",\n                \"fas fa-underline\",\n                \"xypp-more-bbcode.forum.fonts.underline\",\n                bbcode(\"[ins]\"));\n        }\n    );\n    // Typography\n    tags.group(priority(), \"typography\",\n        \"fas fa-paragraph\",\n        \"xypp-more-bbcode.forum.typography.title\", (tags) => {\n            const priority = prioritySerial(100, 100);\n            //Link\n            tags.add(priority(), \"url\",\n                \"fas fa-link\",\n                \"xypp-more-bbcode.forum.typography.link\",\n                selectBBCodeOrNormal(\n                    bbcode(`[URL=${common(\"url\")} title=${common(\"title\")}]`),\n                    merge(pair(\"[\", \"](\" + common(\"url\") + \")\"), {\n                        replaceNext: 'https://',\n                        scanFor: 'https?://'\n                    })));\n            //Image\n            tags.add(priority(), \"image\",\n                \"fas fa-image\",\n                \"xypp-more-bbcode.forum.typography.image\",\n                selectBBCodeOrNormal(\n                    prefix(`[IMG src=\"${common(\"url\")}\" title=\"${common(\"title\")}\" alt=\"${common(\"simple\")}\" height=\"auto\" width=\"auto\"]`),\n                    merge(pair('![', '](' + common(\"url\") + ')'), {\n                        replaceNext: 'https://',\n                        scanFor: 'https?://'\n                    })));\n            //Quote\n            tags.add(priority(), \"quote\",\n                \"fas fa-quote-right\",\n                \"xypp-more-bbcode.forum.typography.quote\",\n                selectBBCodeOrNormal(\n                    merge(bbcode(\"[quote]\"), {\n                        multiline: true\n                    }),\n                    merge(prefix(\"> \"), {\n                        multiline: true,\n                        surroundWithNewlines: true\n                    })));\n            //Code\n            tags.add(priority(), \"code\",\n                \"fas fa-code\",\n                \"xypp-more-bbcode.forum.typography.code\",\n                selectBBCodeOrNormal(\n                    merge(bbcode(`[code lang=${common(\"any\")}]`), {\n                        multiline: true\n                    }),\n                    merge(pair(\"`\", undefined, false), {\n                        blockPrefix: '```',\n                        blockSuffix: '```'\n                    })));\n            //Spoiler\n            tags.add(priority(), \"spoiler\",\n                \"fas fa-eye-slash\",\n                \"xypp-more-bbcode.forum.typography.spoiler\",\n                selectBBCodeOrNormal(\n                    merge(bbcode(`[spoiler title=${common(\"title\")}]`), {\n                        multiline: true\n                    }),\n                    merge(pair(\">!\", \"!<\"), {\n                        blockPrefix: '>! ',\n                        multiline: true\n                    })));\n            //Dropcap\n            tags.add(priority(), \"dropcap\",\n                \"fas fa-caret-right\",\n                \"xypp-more-bbcode.forum.typography.dropcap\",\n                bbcode(\"[dropcap] \"));\n            tags.space(priority());\n            //Horizontal Line\n            tags.add(priority(), \"horizontal-line\",\n                \"fas fa-minus\",\n                \"xypp-more-bbcode.forum.typography.horizontal_line\",\n                bbcode(\"[hr]\"));\n            //Table\n            tags.add(priority(), \"table\",\n                \"fas fa-table\",\n                \"xypp-more-bbcode.forum.typography.table\",\n                selectBBCodeOrNormal(\n                    prefix(`\n[TABLE]\n    [THEAD]\n        [TH]${common(\"column\")}[TH]\n        [TH]${common(\"column\")}[TH]\n        [TH]${common(\"any\")}[TH]\n    [/THEAD]\n    [TBODY]\n        [TR]\n            [TD]${common(\"text\")}[TD]\n            [TD]${common(\"text\")}[TD]\n            [TD]${common(\"any\")}[TD]\n        [/TR]\n    [/TBODY]\n[/TABLE]\n`),\n                    prefix(`\n| ${common(\"column\")} | ${common(\"column\")} | ${common(\"column\")} | ${common(\"column\")} |\n|---|---|---|---|\n| ${common(\"any\")} | ${common(\"any\")} | ${common(\"any\")} | ${common(\"any\")} |\n`)\n                ));\n            //Unordered List\n            tags.add(priority(), \"list-ul\",\n                \"fas fa-list-ul\",\n                \"xypp-more-bbcode.forum.typography.unordered_list\",\n                selectBBCodeOrNormal(\n                    prefix(`\n[list]\n[*]${common(\"any\")}\n[*]${common(\"any\")}\n[*]${common(\"any\")}\n[/list]\n`),\n                    merge(prefix(\"\\n- \"), {\n                        multiline: true,\n                        surroundWithNewlines: true\n                    })));\n            //Ordered List\n            tags.add(priority(), \"list-ol\",\n                \"fas fa-list-ol\",\n                \"xypp-more-bbcode.forum.typography.ordered_list\",\n                selectBBCodeOrNormal(\n                    prefix(`\n[list=1]\n[*]${common(\"any\")}\n[*]${common(\"any\")}\n[*]${common(\"any\")}\n[/list]\n`),\n                    merge(prefix(\"\\n1. \"), {\n                        multiline: true,\n                        orderedList: true,\n                        surroundWithNewlines: true\n                    })));\n        }\n    )\n    //Heading\n    tags.group(priority(), \"heading\",\n        \"fas fa-heading\",\n        \"xypp-more-bbcode.forum.heading.title\",\n        (tags) => {\n            const priority = prioritySerial(100, 100);\n            const levels = [1, 2, 3, 4, 5, 6];\n            levels.forEach(level => {\n                tags.add(priority(), \"heading-\" + level,\n                    false,\n                    { key: \"xypp-more-bbcode.forum.heading.label\", params: { level: level } },\n                    selectBBCodeOrNormal(bbcode(`[H${level}]`), pair(\"#\".repeat(level) + \" \", \" \" + (\"#\".repeat(level)))));\n            });\n        }\n    );\n    //Aligns\n    tags.group(priority(), \"align\",\n        \"fas fa-align-justify\",\n        \"xypp-more-bbcode.forum.align.title\", (tags) => {\n            const priority = prioritySerial(100, 100);\n            // + Align left\n            tags.add(priority(), \"align-left\",\n                \"fas fa-align-left\",\n                \"xypp-more-bbcode.forum.align.align_left\",\n                bbcode(\"[left]\"));\n            // + Align center\n            tags.add(priority(), \"align-center\",\n                \"fas fa-align-center\",\n                \"xypp-more-bbcode.forum.align.align_center\",\n                bbcode(\"[center]\"));\n            // + Align right\n            tags.add(priority(), \"align-right\",\n                \"fas fa-align-right\",\n                \"xypp-more-bbcode.forum.align.align_right\",\n                bbcode(\"[right]\"));\n            // + Justify\n            tags.add(priority(), \"justify\",\n                \"fas fa-align-justify\",\n                \"xypp-more-bbcode.forum.align.align_justify\",\n                bbcode(\"[justify]\"));\n            tags.space(priority());\n            //Padding\n            // + Padding Left\n            tags.add(priority(), \"padding-left\",\n                \"fas fa-arrow-alt-circle-left\",\n                \"xypp-more-bbcode.forum.align.padding_left\",\n                bbcode(\"[pleft]\"));\n            tags.add(priority(), \"padding-right\",\n                \"fas fa-arrow-alt-circle-right\",\n                \"xypp-more-bbcode.forum.align.padding_right\",\n                bbcode(\"[pright]\"));\n            tags.space(priority());\n            //Image Positioning\n            //+ Image Left\n            tags.add(priority(), \"image-left\",\n                () => <div className=\"stackIcon\">\n                    <i className=\"fas fa-image main\" />\n                    <i className=\"fas fa-arrow-alt-circle-left lb-corner\" />\n                </div>,\n                \"xypp-more-bbcode.forum.align.image_left\",\n                bbcode(\"[ileft]\"));\n            //+ Image Center\n            tags.add(priority(), \"image-center\",\n                () => <div className=\"stackIcon\">\n                    <i className=\"fas fa-image main\" />\n                    <i className=\"fas fa-arrow-alt-circle-up cb-corner\" />\n                </div>,\n                \"xypp-more-bbcode.forum.align.image_center\",\n                bbcode(\"[icenter]\"))\n            //+ Image Right\n            tags.add(priority(), \"image-right\",\n                () => <div className=\"stackIcon\">\n                    <i className=\"fas fa-image main\" />\n                    <i className=\"fas fa-arrow-alt-circle-right rb-corner\" />\n                </div>,\n                \"xypp-more-bbcode.forum.align.image_right\",\n                bbcode(\"[iright]\"));\n        });\n    //Size\n    tags.group(priority(), \"size\",\n        \"fas fa-text-height\",\n        \"xypp-more-bbcode.forum.size.title\", (tags) => {\n            const sizes = [18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40]\n            const priority = prioritySerial(100, 100);\n            sizes.forEach(size => {\n                tags.add(priority(), \"size-\" + size,\n                    false,\n                    { key: \"xypp-more-bbcode.forum.size.label\", params: { size: size } },\n                    bbcode(`[size=${size}]`));\n            });\n        }, 2\n    );\n    //Color\n    tags.group(priority(), \"color\",\n        \"fas fa-palette\",\n        \"xypp-more-bbcode.forum.color.title\", (tags) => {\n            const colors = [\n                \"grey\", \"green\", \"blue\", \"purple\", \"yellow\", \"orange\",\n                \"red\", \"silver\", \"pink\", \"brown\", \"white\", \"black\"]\n            const priority = prioritySerial(100, 100);\n            colors.forEach(color => {\n                tags.add(priority(), \"color-\" + color,\n                    () => <span style={`background:${color};`} className=\"color-indicator text\">A</span>,\n                    { key: \"xypp-more-bbcode.forum.color.label\", params: { color: color } },\n                    bbcode(`[color=${color}]`));\n            });\n        }, 2\n    )\n    //BackGround\n    tags.group(priority(), \"background\",\n        () => <i className=\"fas fa-fill-drip\" />,\n        \"xypp-more-bbcode.forum.background.title\", (tags) => {\n            const colors = [\n                \"grey\", \"green\", \"blue\", \"purple\", \"yellow\", \"orange\",\n                \"red\", \"silver\", \"pink\", \"brown\", \"white\", \"black\"]\n            const priority = prioritySerial(100, 100);\n            colors.forEach(color => {\n                tags.add(priority(), \"background-\" + color,\n                    () => <span style={`background:${color};`} className=\"color-indicator back\"></span>,\n                    { key: \"xypp-more-bbcode.forum.background.label\", params: { color: color } },\n                    bbcode(`[background=${color}]`));\n            });\n        }, 2\n    )\n    //Sign\n    tags.group(priority(), \"sign\",\n        \"fas fa-superscript\",\n        \"xypp-more-bbcode.forum.sign.title\", (tags) => {\n            const priority = prioritySerial(100, 100);\n            //Superscript\n            tags.add(priority(), \"superscript\",\n                \"fas fa-superscript\",\n                \"xypp-more-bbcode.forum.sign.superscript\",\n                bbcode(\"[sup]\"));\n            //Subscript\n            tags.add(priority(), \"subscript\",\n                \"fas fa-subscript\",\n                \"xypp-more-bbcode.forum.sign.subscript\",\n                bbcode(\"[sub]\"));\n            //Acronym\n            tags.add(priority(), \"acronym\",\n                \"fas fa-question-circle\",\n                \"xypp-more-bbcode.forum.sign.acronym\",\n                bbcode(`[acronym title=\\\"${common(\"title\")}\\\"] ${common(\"describe\")}`));\n        }\n    )\n}","\nimport CommentPost from \"flarum/forum/components/CommentPost\";\nimport DiscussionPage from \"flarum/forum/components/DiscussionPage\";\nimport DiscussionControls from \"flarum/forum/utils/DiscussionControls\";\nimport LogInModal from \"flarum/forum/components/LogInModal\";\nimport TagCollector from \"../helper/tagCollector\";\nimport { prioritySerial } from \"../utils/nodeUtil\";\nimport { bbcode } from \"../utils/styleUtil\";\nimport app from \"flarum/forum/app\";\nimport { extend } from \"flarum/common/extend\";\nimport Alert from \"flarum/common/components/Alert\";\nimport setRouteWithForcedRefresh from \"flarum/common/utils/setRouteWithForcedRefresh\";\n\n\nexport function addXX2SeeTags(tags: TagCollector, priority: () => number) {\n    //xx2see\n    tags.group(priority(), \"xx2see\",\n        \"fas fa-eye\",\n        \"xypp-more-bbcode.forum.xx2see.title\", (tags) => {\n            const priority = prioritySerial(100, 100);\n            //Login 2 See\n            tags.add(priority(), \"login2see\",\n                \"fas fa-user\",\n                \"xypp-more-bbcode.forum.xx2see.login.title\",\n                bbcode(\"[login]\")\n            );\n\n            //Reply 2 See\n            tags.add(priority(), \"reply2see\",\n                \"fas fa-reply\",\n                \"xypp-more-bbcode.forum.xx2see.reply.title\",\n                bbcode(\"[reply]\")\n            );\n\n            //Like 2 See\n            tags.add(priority(), \"like2see\",\n                \"fas fa-heart\",\n                \"xypp-more-bbcode.forum.xx2see.like.title\",\n                bbcode(\"[like]\")\n            );\n        }\n    );\n\n\n    extend(CommentPost.prototype, \"content\", function () {\n        if (app.session.user && app.current.matches(DiscussionPage)) {\n            $(\".reply2see_reply\")\n                .off(\"click\")\n                .on(\"click\", () =>\n                    DiscussionControls.replyAction.call(\n                        app.current.get(\"discussion\"),\n                        true,\n                        false\n                    )\n                );\n        } else {\n            $(\".reply2see_reply\")\n                .off(\"click\")\n                .on(\"click\", () => app.modal.show(LogInModal));\n            $(\".login2see_login\")\n                .off(\"click\")\n                .on(\"click\", () => app.modal.show(LogInModal));\n        }\n    });\n}"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","flarum","core","compat","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","_inheritsLoose","subClass","superClass","create","constructor","showIf","judgement","vnode","def","prioritySerial","startValue","step","value","ret","align","base","elem","_base$offsetParent","_base$offsetParent$of","_base$offset","parentOffset","offsetParent","offset","left","realLeft","screenWid","$","document","body","width","targetWidth","globalOffset","css","buttonBar","_Component","_this","_len","arguments","length","args","Array","_key","apply","concat","selectedSub","applyStyleInline","style","_style$prefix","_style$suffix","ed","attrs","editor","prefix","suffix","getSelectionRange","getValue","replaceSelection","_ed$getSelectionRange","start","end","selected","slice","text","focus","pos","setSelectionRange","ta","querySelector","_ta$selectionStart","_ta$selectionEnd","s","selectionStart","e","selectionEnd","setRangeText","dispatchEvent","Event","bubbles","_proto","view","_this2","rows","this","tags","tagCollect","groups","filter","tag","type","bottom","m","className","classList","getTags","map","group","component","name","onupdate","element","find","children","preRow","Math","floor","currentRow","i","push","getTagComponent","row","clsName","icon","Tooltip","tooltip","position","Button","onclick","clickEventWarper","_this3","event","currentTarget","blur","clickEvent","_this4","redraw","data","Promise","then","Component","TagCollector","ItemList","spaceKey","getTranslation","app","trans","params","add","priority","tooltipKey","collect","space","callback","newGroup","item","clear","keys","toObject","forEach","k","remove","arr","toArray","disabled","attribute","itemName","reverse","common","_app$session","_app$session$user","user","preferences","selectBBCodeOrNormal","bbcode","normal","pref","collectAll","checkDevice","target","current","merge","assign","pair","trim","trimFirst","code","regex","exec","_trans","dat","isArray","join","alertPreviewModal","_Modal","done","typesOpt","availableMap","colorMap","available","oninit","title","content","availableDict","v","for","Select","options","onchange","generateStyle","custom","generateBBCode","s9e","TextFormatter","preview","onsubmit","preventDefault","close","onbeforeremove","oncancel","Modal","makeAlert","resolve","reject","show","tabId","createTab","each","container","$container","$inputs","$items","num","attr","is","setAttribute","$item","id","cloudPreviewModal","opts","makeCloud","replaceNext","scanFor","multiline","surroundWithNewlines","undefined","blockPrefix","blockSuffix","orderedList","level","repeat","size","color","addTypographyButtons","extend","CommentPost","ComposerPostPreview","addUtilitiesTags","addEmbedTags","matches","DiscussionPage","off","on","DiscussionControls","LogInModal","addXX2SeeTags","config","hasAddCollectBtn","showMoreBBcodeButtons","val","TextEditor","items","_this$attrs","_this$attrs$composer","collect_all","remove_markdown","collect_markdown","minPriority","getPriority","min","has","g_tags","TextEditorButton","composer","SettingsPage","fm","FieldSet","label","saveObj","savePreferences"],"sourceRoot":""}